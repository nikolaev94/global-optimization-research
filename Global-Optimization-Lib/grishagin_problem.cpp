#include "grishagin_problem.h"

double GrishaginProblem::rand_minimums[] = {
	0.603052, 0.408337,
	0.652988, 0.320592,
	1.000000, 0.000000,
	0.066182, 0.582587,
	0.904308, 0.872639,
	0.344375, 0.524932,
	0.000000, 1.000000,
	0.948275, 0.887031,
	0.226047, 0.520153,
	0.341732, 0.197620,
	0.069264, 0.430955,
	0.000000, 1.000000,
	0.45221, 0.07292,
	0.579769, 0.046396,
	0.000000, 1.000000,
	0.310179, 1.000000,
	0.909758, 0.926195,
	0.434562, 0.825608,
	0.06686, 0.77051,
	0.641337, 0.135186,
	0.885029, 0.390289,
	0.649650, 0.414282,
	0.142623, 0.157327,
	0.862953, 1.000000,
	0.46036, 0.99314,
	0.379189, 0.688051,
	0.845292, 0.424546,
	0.441160, 0.016803,
	1.000000, 1.000000,
	0.303295, 0.134722,
	0.109520, 0.265486,
	1.000000, 0.000000,
	0.593726, 0.503014,
	0.694905, 1.000000,
	0.051975, 0.409344,
	0.125664, 0.518969,
	0.000000, 0.000000,
	0.155081, 0.238663,
	0.53707, 0.46181,
	0.110985, 0.917791,
	1.000000, 0.000000,
	0.776095, 0.764724,
	0.087367, 0.677632,
	0.308037, 0.536113,
	0.042100, 0.563607,
	0.287025, 0.159219,
	0.451926, 0.169839,
	0.884761, 0.245341,
	0.047782, 0.171633,
	0.00000, 0.41596,
	0.192108, 0.303789,
	0.554153, 0.809821,
	0.91475, 0.54149,
	0.661592, 0.925902,
	0.962924, 0.436680,
	0.000000, 0.000000,
	0.616058, 0.560244,
	0.439890, 0.343722,
	0.218146, 0.677192,
	1.000000, 1.000000,
	0.198145, 0.317876,
	0.875874, 0.653336,
	0.22999, 0.33624,
	0.169351, 0.015656,
	0.760073, 0.906035,
	0.702941, 0.308403,
	0.365371, 0.282325,
	0.314012, 0.651377,
	0.237687, 0.374368,
	0.586334, 0.508672,
	0.000000, 0.000000,
	0.383319, 1.000000,
	0.780103, 0.103783,
	0.350265, 0.566946,
	0.798535, 0.478706,
	0.31759, 0.06967,
	0.715929, 0.704778,
	0.563040, 0.442557,
	0.565078, 0.322618,
	0.146731, 0.510509,
	0.000000, 0.543167,
	0.208533, 0.454252,
	0.155111, 0.972329,
	0.000000, 1.000000,
	0.336467, 0.909056,
	0.57001, 0.90847,
	0.296290, 0.540579,
	0.172262, 0.332732,
	0.000000, 1.000000,
	1.000000, 0.000000,
	1.000000, 1.000000,
	0.674061, 0.869954,
	1.000000, 1.000000,
	0.852506, 0.637278,
	0.877491, 0.399780,
	0.835605, 0.751888,
	0.673378, 0.827427,
	0.831754, 0.367117,
	0.601971, 0.734465,
	0.000000, 0.000000
};


GrishaginProblem::GrishaginProblem(GrishaginFunction::GrishaginFunctionPtr obj)
	: objective(obj) {}

GrishaginProblem::~GrishaginProblem() {}

double GrishaginProblem::getDistance(double point[], double min_point[])
{
	double sum = 0.0;
	for (size_t i = 0; i < 2; i++)
	{
		sum += pow((point[i] - min_point[i]), 2.0);
	}
	return sqrt(sum);
}

double GrishaginProblem::getReferenceMinError(double scalar)
{
	double trial_point[2];
	GrishaginFunction::mapScalarTo2DSpace(scalar, trial_point);

	int number = objective->getFunctionSequentialNumber();

	double min_point[] = { rand_minimums[number * 2 - 2], rand_minimums[number * 2 - 1] };

	return getDistance(trial_point, min_point);
}

unsigned GrishaginProblem::getDimention()
{
	return 2;
}


double GrishaginProblem::getObjectiveValue(double arg)
{
	return objective->getValue(arg);
}


double GrishaginProblem::getReferenceMinimum()
{
	return 0.0;
}


double GrishaginProblem::getContraintValue(std::size_t number, double arg)
{
	return 0.0;
}


std::size_t GrishaginProblem::getConstraintsNumber() const
{
	return 0;
}
